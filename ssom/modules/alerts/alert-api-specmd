# ğŸ“¢ Alert API ë¬¸ì„œ

## 1. ì•Œë¦¼ SSE êµ¬ë…
ì‹¤ì‹œê°„ ì•Œë¦¼ì„ ìˆ˜ì‹ í•˜ê¸° ìœ„í•´ SSE(Server-Sent Events) ì—°ê²°ì„ ì‹œì‘í•©ë‹ˆë‹¤.

**Endpoint**
```
GET /api/alert/subscribe
```

**Headers**

| ì´ë¦„ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| Authorization | string | âœ… | Bearer í† í° |
| Last-Event-ID | string | âŒ | ë§ˆì§€ë§‰ ìˆ˜ì‹  ì´ë²¤íŠ¸ ID (ì˜µì…˜) |

**Produces**  
`text/event-stream`

**ì˜ˆì‹œ ì‘ë‹µ**
```
event: SSE_ALERT_INIT
id: 20240604_abcdef123456
data: connected
```

---

## 2. ì „ì²´ ì•Œë¦¼ ëª©ë¡ ì¡°íšŒ
```
GET /api/alert
```

**Headers**
Authorization í—¤ë” í•„ìš”

**Response**
JSON í˜•ì‹ ì•Œë¦¼ ë°°ì—´ ë°˜í™˜

---

## 3. ì•Œë¦¼ ê°œë³„ ìƒíƒœ ë³€ê²½
```
PATCH /api/alert/modify
```

**Request Body**
```json
{
  "alertStatusId": 1234,
  "isRead": true
}
```

---

## 4. ì•Œë¦¼ ê°œë³„ ì‚­ì œ
```
PATCH /api/alert/delete
```

**Request Body**
```json
{
  "alertStatusId": 1234
}
```

---

## 5. FCM í† í° ë“±ë¡
```
POST /api/fcm/register
```

**Headers**
X-User-Id í•„ìš”

**Request Body**
```json
{
  "fcmToken": "fcm_token_value"
}
```

---

## 6. ê·¸ë¼íŒŒë‚˜ ì•Œë¦¼ ì „ì†¡
```
POST /api/alert/grafana
```

**Request Body**
```json
{
  "alerts": [
    {
      "app": "ssok-bluetooth-service",
      "level": "warning",
      "message": "...",
      "timestamp": "2025-05-31T00:14:01.472Z",
      "id": "686692198126160f"
    }
  ]
}
```

---

## 7. ì˜¤í”ˆì„œì¹˜ ëŒ€ì‹œë³´ë“œ ì•Œë¦¼ ì „ì†¡
```
POST /api/alert/opensearch
```

**Request Body**
```json
{
  "request": "{...JSON string...}"
}
```

---

## 8. ì´ìŠˆ ìƒì„± ì•Œë¦¼ ì „ì†¡
```
POST /api/alert/issue
```

**Request Body**
```json
{
  "timestamp": "2025-06-04T12:00:00Z",
  "sharedEmployeeIds": ["user1", "user2", "user3"]
}
```

---

## 9. Jenkins ë° ArgoCD ì•Œë¦¼ ì „ì†¡
```
POST /api/alert/send
```

**Request Body**
```json
{
  "id": "someId",
  "level": "INFO",
  "app": "jenkins_ssok-bank",
  "timestamp": "2025-06-04T12:00:00Z",
  "message": "ë¹Œë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
}
```